{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "D&D 5e Races",
  "type": "array",
  "items": {
    "description": "Complete D&D 5e race definition.",
    "properties": {
      "id": {
        "description": "Unique prefixed slug ID",
        "title": "Id",
        "type": "string"
      },
      "name": {
        "description": "Race name",
        "title": "Name",
        "type": "string"
      },
      "description": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": "Race description and flavor text",
        "title": "Description"
      },
      "base_race": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": "Base race name (null for base races)",
        "title": "Base Race"
      },
      "size": {
        "description": "Size category",
        "title": "Size",
        "type": "string"
      },
      "speed": {
        "description": "Base walking speed",
        "title": "Speed",
        "type": "integer"
      },
      "creature_type": {
        "description": "Creature type (e.g., Humanoid, Fey)",
        "title": "Creature Type",
        "type": "string"
      },
      "ability_score_increases": {
        "additionalProperties": {
          "type": "integer"
        },
        "description": "Ability score increases",
        "title": "Ability Score Increases",
        "type": "object"
      },
      "vision_type": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": "Vision type",
        "title": "Vision Type"
      },
      "vision_range": {
        "anyOf": [
          {
            "type": "integer"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": "Vision range in feet",
        "title": "Vision Range"
      },
      "requires_sleep": {
        "anyOf": [
          {
            "type": "boolean"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": "Whether race requires sleep",
        "title": "Requires Sleep"
      },
      "rest_duration": {
        "anyOf": [
          {
            "type": "integer"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": "Hours of rest required",
        "title": "Rest Duration"
      },
      "rest_type": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": "Type of rest (e.g., trance, sleep)",
        "title": "Rest Type"
      },
      "subraces": {
        "description": "Available subraces",
        "items": {
          "type": "string"
        },
        "title": "Subraces",
        "type": "array"
      },
      "traits": {
        "description": "Racial traits with mechanics",
        "items": {
          "$ref": "#/$defs/RaceTrait"
        },
        "title": "Traits",
        "type": "array",
        "default": []
      },
      "languages": {
        "description": "Languages known by this race",
        "items": {
          "$ref": "#/$defs/RaceLanguage"
        },
        "title": "Languages",
        "type": "array",
        "default": []
      },
      "source": {
        "description": "Source book",
        "title": "Source",
        "type": "string"
      },
      "ruleset": {
        "description": "Ruleset version",
        "title": "Ruleset",
        "type": "string"
      }
    },
    "required": ["id", "name", "size", "speed", "creature_type", "source", "ruleset"],
    "title": "Race",
    "type": "object"
  },
  "$defs": {
    "RaceTrait": {
      "description": "A racial trait with mechanics.",
      "type": "object",
      "properties": {
        "name": {
          "description": "Trait name",
          "title": "Name",
          "type": "string"
        },
        "description": {
          "description": "Trait description",
          "title": "Description",
          "type": "string"
        },
        "damage": {
          "anyOf": [
            {
              "$ref": "common.schema.json#/$defs/Damage"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Damage specification for damage-dealing traits"
        },
        "scaling": {
          "anyOf": [
            {
              "$ref": "common.schema.json#/$defs/Scaling"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Scaling specification for level-based traits"
        },
        "mechanics": {
          "description": "Structured game mechanics for this trait",
          "items": {
            "discriminator": {
              "mapping": {
                "action": "#/$defs/BaseMechanic",
                "advantage": "#/$defs/BaseMechanic",
                "bonus_action": "#/$defs/BaseMechanic",
                "choice": "#/$defs/ChoiceMechanic",
                "critical_hit": "#/$defs/BaseMechanic",
                "damage_bonus": "#/$defs/BaseMechanic",
                "extra_attack": "#/$defs/BaseMechanic",
                "extra_turn": "#/$defs/BaseMechanic",
                "granted_spells": "#/$defs/GrantedSpellsMechanic",
                "immunity": "#/$defs/BaseMechanic",
                "movement": "#/$defs/BaseMechanic",
                "optional": "#/$defs/BaseMechanic",
                "passive": "#/$defs/BaseMechanic",
                "proficiency": "#/$defs/ProficiencyMechanic",
                "reaction": "#/$defs/BaseMechanic",
                "resistance": "#/$defs/BaseMechanic",
                "resource": "#/$defs/ResourceMechanic",
                "retrain": "#/$defs/RetrainMechanic",
                "ritual": "#/$defs/BaseMechanic",
                "special": "#/$defs/BaseMechanic",
                "spellcasting": "#/$defs/SpellcastingMechanic"
              },
              "propertyName": "type"
            },
            "oneOf": [
              {
                "$ref": "common.schema.json#/$defs/ResourceMechanic"
              },
              {
                "$ref": "common.schema.json#/$defs/ChoiceMechanic"
              },
              {
                "$ref": "common.schema.json#/$defs/RetrainMechanic"
              },
              {
                "$ref": "common.schema.json#/$defs/SpellcastingMechanic"
              },
              {
                "$ref": "common.schema.json#/$defs/GrantedSpellsMechanic"
              },
              {
                "$ref": "common.schema.json#/$defs/ProficiencyMechanic"
              },
              {
                "$ref": "common.schema.json#/$defs/BaseMechanic"
              }
            ]
          },
          "title": "Mechanics",
          "type": "array"
        }
      },
      "required": ["name", "description", "mechanics"],
      "title": "RaceTrait"
    },
    "RaceLanguage": {
      "description": "A language entry for a race.",
      "type": "object",
      "properties": {
        "language": {
          "description": "Language name (e.g., 'Common', 'Elvish')",
          "title": "Language",
          "type": "string"
        },
        "choice": {
          "description": "Whether this is a choice (true) or automatic (false)",
          "title": "Choice",
          "type": "boolean"
        }
      },
      "required": ["language", "choice"],
      "title": "RaceLanguage"
    }
  }
}
